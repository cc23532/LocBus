<%
  function agruparPorSentidoDia(horariosLinha) {
    const agrupado = {};

    // Agrupa os horários por sentido e dia
    horariosLinha.forEach((horario) => {
      const chaveAgrupamento = `${horario.idLinha}_${horario.sentido_nome}`;

      if (!agrupado[chaveAgrupamento]) {
        agrupado[chaveAgrupamento] = {};
      }

      if (!agrupado[chaveAgrupamento][horario.dia]) {
        agrupado[chaveAgrupamento][horario.dia] = [];
      }

      agrupado[chaveAgrupamento][horario.dia].push(horario.horario);
    });

    return agrupado;
  }
%>


<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Horários</title>
</head>
<body>

  <% const horariosAgrupados = agruparPorSentidoDia(horariosLinha); %>

  <% for (const chaveAgrupamento in horariosAgrupados) { %>
    <% const [idLinha, sentidoNome] = chaveAgrupamento.split('_'); %>
    <h2><%= `${idLinha} - ${sentidoNome}` %></h2>

    <% for (const dia in horariosAgrupados[chaveAgrupamento]) { %>
      <h3><%= dia %></h3>
      <ul>
        <% for (const horario of horariosAgrupados[chaveAgrupamento][dia]) { %>
          <li><%= horario %></li>
        <% } %>
      </ul>
    <% } %>
  <% } %>

</body>
</html>
